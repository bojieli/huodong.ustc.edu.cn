<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>选择成员</title>
<link href="/static/css1.css" type="text/css" rel="stylesheet" />
</head>

<body>
<include file="Public:headnav" />


<div id="mainding">



<!--以下为筛选代码以及js代码-->
<SCRIPT LANGUAGE="JavaScript"> 
<!-- Begin 
sortitems = 1;  // Automatically sort items within lists? (1 or 0) 
sort_flagL = 1; //left col.1 or 0 ; 1 stand for "sort by text", 0 stand for "sort by value" 
sort_flagR = 1; //right col 1 or 0 ; 1 stand for "sort by text", 0 stand for "sort by value" 

 function move(fbox,tbox,flag) { 
  for(var i=0; i<fbox.options.length; i++) { 
    if(fbox.options[i].selected && fbox.options[i].value != ""){ 
    	var no = new Option(); 
    	no.value = fbox.options[i].value; 
    	no.text = fbox.options[i].text; 
    	tbox.options[tbox.options.length] = no; 
    	fbox.options[i].value = ""; 
    	fbox.options[i].text = ""; 
    };
  };
  BumpUp(fbox); 
  if (sortitems) SortD(tbox,flag); 
 };
function moveall(fbox,tbox,flag){ 
  for(var i=0; i<fbox.options.length; i++){ 
    if(fbox.options[i].value != ""){ 
    	var no = new Option(); 
    	no.value = fbox.options[i].value; 
    	no.text = fbox.options[i].text; 
    	tbox.options[tbox.options.length] = no; 
    	fbox.options[i].value = ""; 
    	fbox.options[i].text = ""; 
       }; 
  }; 
 BumpUp(fbox); 
 if (sortitems) SortD(tbox,flag); 
 };
function BumpUp(box){ 
  for(var i=0; i<box.options.length; i++){ 
    if(box.options[i].value == ""){ 
       for(var j=i; j<box.options.length-1; j++){ 
       	 box.options[j].value = box.options[j+1].value; 
       	 box.options[j].text = box.options[j+1].text; 
       };
       var ln = i; 
       break; 
    }; 
  }; 
  if(ln < box.options.length)  { 
  	box.options.length -= 1; 
  	BumpUp(box); 
  }; 
}; 

function SortD(box,flag){ 
 var temp_opts = new Array(); 
 var temp = new Object(); 
 for(var i=0; i<box.options.length; i++)  { 
   temp_opts[i] = box.options[i]; 
 } 
if(flag){
 for(var x=0; x<temp_opts.length-1; x++)  { 
   for(var y=(x+1); y<temp_opts.length; y++)  {	   
     if(temp_opts[x].text > temp_opts[y].text)  { 
     	temp = temp_opts[x].text; 
    	temp_opts[x].text = temp_opts[y].text; 
     	temp_opts[y].text = temp; 
     	temp = temp_opts[x].value; 
     	temp_opts[x].value = temp_opts[y].value; 
     	temp_opts[y].value = temp; 
		     };
   };
 };
} //sort by test
else{
   for(var x=0; x<temp_opts.length-1; x++)  { 
   for(var y=(x+1); y<temp_opts.length; y++)  {	   
     if(temp_opts[x].value > temp_opts[y].value)  { 
     	temp = temp_opts[x].text; 
    	temp_opts[x].text = temp_opts[y].text; 
     	temp_opts[y].text = temp; 
     	temp = temp_opts[x].value; 
     	temp_opts[x].value = temp_opts[y].value; 
     	temp_opts[y].value = temp; 
		     };
   };
 };
	}
 for(var i=0; i<box.options.length; i++)  { 
 	box.options[i].value = temp_opts[i].value; 
 	box.options[i].text = temp_opts[i].text; 
  };
};
function MselAuto(fbox,flag1,tbox,flag2){
	if(sortitems){
		sortitems = 0 ;		
		document.getElementById("msel_auto").style.backgroundColor='#fafafa';		
		}
	 else{
		sortitems = 1 ;
		SortD(fbox,flag1);
		SortD(tbox,flag2);
		document.getElementById("msel_auto").style.backgroundColor='#f0f0f0';
		 }
	};
function Mselchoose(tbox,flag,num,item_id1,item_id2){
	//tbox 为要排列的序列的 select 框的 name
	//flag 为tbox对应的排序规则对应的flag变量
	//num 为 flag 对应的该改成的值 0 or 1
	//item_id1 为对应点击的 button 的id, item_id2为点击button对应互斥button的id	
		flag = num ;
		document.getElementById(item_id1).style.backgroundColor='#fafafa';
		document.getElementById(item_id2).style.backgroundColor='#f0f0f0';		
		SortD(tbox,flag);		
	}
	// End --> 
</script> 
<!--筛选列表的css样式表-->
<style type="text/css">
.mem-select{	
	width:250px;
	font-size:16px;	
	padding:5px;
	font-family:Microsoft Yahei, "Times New Roman", Times, serif;
	line-height:20px;
	vertical-align:middle;	
	}
.msel-button{
	margin-top:15px;
	margin-left:19px;
	padding:0;
	font-size:20px;
	font-weight:bold;
	color:#333;
	height:30px;	
	line-height:24px;
	vertical-align:middle;
	width:60px;
	text-align:center;
	}
.msel-button-sort{
	color:#99F;
	font-size:16px;		
	height:24px;	
	line-height:22px;
	vertical-align:middle;
	width:90px;
	text-align:center;
	border-radius:0px;	
	}


</style>

<!--下面是选择的form代码-->
<form ACTION="/Sms/tid" METHOD="post" name="sms" onSubmit= "return subm()"> 
<table border="0" cellpadding="0" cellspacing="0">
 <tr  height="26px" valign="middle">
 	<td style=" font-family:microsoft Yahei;" align="center">待选列表</td>
    <td></td>
    <td style="color:#690; font-family:microsoft Yahei;" align="center">已选列表</td>
 </tr> 
  <tr  height="30px" valign="middle">
 	<td style="border:1px solid #CCC;" align="center">
    	<input id="msel_Lxh" class="dxhb-button msel-button-sort" style=" width:120px;" type="button" value="序号排序" onclick="Mselchoose(this.form.list1,sort_flagL,0,'msel_Lxh','msel_Lmc')" >
		<input id="msel_Lmc" class="dxhb-button msel-button-sort" style=" width:120px;  background:#fafafa;" type="button" value="名称排序" onclick="Mselchoose(this.form.list1,sort_flagL,1,'msel_Lmc','msel_Lxh')" >
    </td>
    <td style="border:1px solid #CCC; border-left:0 solid #FFF; border-right:0 solid #FFF;" align="center">
    	<input id="msel_auto" class="dxhb-button msel-button-sort" style=" width:96px; background:#fafafa;" type="button" value="自动排序" onclick="MselAuto(this.form.list1,sort_flagL,this.form.list2,sort_flagR)" >
    </td>
    <td style="border:1px solid #CCC;" align="center">
    	<input id="msel_Rxh" class="dxhb-button msel-button-sort" style=" width:120px; " type="button" value="序号排序" onclick="Mselchoose(this.form.list2,sort_flagR,0,'msel_Rxh','msel_Rmc')" >
        <input id="msel_Rmc" class="dxhb-button msel-button-sort" style=" width:120px;  background:#fafafa;" type="button" value="名称排序" onclick="Mselchoose(this.form.list2,sort_flagR,1,'msel_Rmc','msel_Rxh')" >
    </td>
 </tr>
  
 <tr>
	<td><select multiple size="20" name="list1"  class="mem-select dxhb-blur" onfocus="this.className='mem-select dxhb-focus'" onblur="this.className='mem-select dxhb-blur'"> 
		  <option value="11">沈佳宜 -- PB12013100</option> 
		  <option value="12">沈雪宜 -- PB12013100</option> 
		  <option value="13">方清雪 -- PB12013100</option>
          <option value="11">沈佳宜 -- PB12013100</option> 
		  <option value="12">沈雪宜 -- PB12013100</option> 
		  <option value="13">方清雪 -- PB12013100</option>
          <option value="11">沈佳宜 -- PB12013100</option> 
		  <option value="12">沈雪宜 -- PB12013100</option> 
		  <option value="13">方清雪 -- PB12013100</option>
          <option value="13">方清雪 -- PB12013100</option>
          <option value="11">沈佳宜 -- PB12013100</option> 
		  <option value="12">沈雪宜 -- PB12013100</option> 
		  <option value="13">方清雪 -- PB12013100</option>
          <option value="11">沈佳宜 -- PB12013100</option> 
		  <option value="12">沈雪宜 -- PB12013100</option> 
		  <option value="13">方清雪 -- PB12013100</option>  
		</select>
    </td> 
	<td width="100" align="left" valign="top">
		<input class="dxhb-button msel-button" type="button" value=">" onclick="move(this.form.list1,this.form.list2,sort_flagR)" name="B1">
		<input class="dxhb-button msel-button" type="button" value="<" onclick="move(this.form.list2,this.form.list1,sort_flagL)" name="B2">
        <br/><br/>
		<input class="dxhb-button msel-button" type="button" value=">>" onclick="moveall(this.form.list1,this.form.list2,sort_flagR)" name="B3">
		<input class="dxhb-button msel-button" type="button" value="<<" onclick="moveall(this.form.list2,this.form.list1,sort_flagL)" name="B4"> 
   </td> 
   <td><select multiple size="20" name="list2"   class="mem-select dxhb-blur" onfocus="this.className='mem-select dxhb-focus'" onblur="this.className='mem-select dxhb-blur'" style="color:#690;"> 
		  <option value="21"> item 2.1 </option> 
		  <option value="22"> item 2.2 </option> 
	  	  <option value="23"> item 2.3 </option>
          <option value="45"> 王国维 </option> 
          <option value="46"> 易建飞 </option> 
          <option value="13"> 叶秋 - 13 - 21212121212</option>
          <option value="15"> 王国维 - 15 - 123132123 </option> 
          <option value="17"> 易建飞 - 17 - 156456 </option> 
          <option value="20"> 叶秋 - 20 - 12132123 </option>   
		</select>
   </td>
</tr> 
</table> 
<input type="hidden" name="tid"/>
<input type="submit" value="提交"/>
</form> 
<script> 
function subm(){ 
for(var i=0;i<document.sms.list2.length;i++){ 
	document.sms.tid.value+=document.sms.list2.options[i].value; 
	if(i!=(document.sms.list2.length-1))
	{ 
	document.sms.tid.value+=';'; 
	}
} 
return true;	
}
</script>

<!--以上为筛选代码以及js代码-->



</div><!--main ding-->
</body>
</html>
