<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:c="http://java.sun.com/jsp/jstl/core">
    <h:head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
        <link rel="stylesheet" type="text/css" href="css/tooltip.css" />
        <script type="text/javascript" src="javascript/cvi_tip_lib.js"></script>
        <style type="text/css">
            body {
                margin: 0;
                padding: 0;
                font-family: geneva, arial, helvetica, sans-serif;
                font-size:80%;
            }
            .ui-growl{
                top: 200px;
            }
            .ui-dialog .ui-dialog-content {
                padding: 0 0 0 0;
            }
        </style>


    </h:head>
    <h:body >
        <f:view>
            <h:form id="form">
                <p:growl id="growl" showDetail="true" sticky="false" autoUpdate="true"/> 
                <p:inputText value="#{groupBean.inputgroup}" id="groupid" style="display: none" />

                <p:layout fullPage="true" >

                    <p:dialog widgetVar="newp" modal="true">
                        <h:panelGrid columns="2" cellpadding="20">
                            <h:outputText value="项目名称："/>
                            <p:inputText value="#{groupBean.newProjectName}" />
                            <p:commandButton value="确定" action="#{groupBean.newProjectNode}" ajax="false" update="form"/>
                        </h:panelGrid>
                    </p:dialog>

                    <p:layoutUnit id="right" position="east" size="380" resizable="true" closable="false" collapsible="true" >
                        <p:accordionPanel id="groupApanel">


                            <p:tab id="groupA" title="#{groupBean.mygroup.name}" >
                                <p:tree   cache="false" id="groupAtree" value="#{groupBean.root}" var="doc" selectionMode="single" selection="#{groupBean.selectedNode}"   >  

                                    <p:treeNode  icon="ui-icon ui-icon-person"    > 
                                        <h:outputText value="#{doc}" /> 
                                    </p:treeNode>
                                </p:tree> 
                                <p:contextMenu for="groupAtree">  
                                    <p:menuitem value="刷新"  icon="ui-icon ui-icon-newwin" ajax="false"  update="form" /> 
                                    <p:menuitem value="新建项目"  icon="ui-icon ui-icon-newwin" onclick="newp.show();"/> 
                                    <c:forEach items="#{groupBean.myProject}" var="uug">
                                        <p:menuitem value="移动到#{uug.name}"  icon="ui-icon ui-icon-newwin" onclick="document.getElementById('form:groupid').value='#{uug.pid}';" action="#{groupBean.moveToGroupNode}" ajax="false"  update="form" /> 
                                    </c:forEach>
                                </p:contextMenu> 
                            </p:tab>
                            <p:tab title="我的群组B" >
                            </p:tab>

                        </p:accordionPanel>
                    </p:layoutUnit>

                    <p:layoutUnit  position="center">

                        <p:contextMenu for="dataTable"> 
                            <p:menuitem value="刷新"  icon="ui-icon ui-icon-newwin" ajax="false" update="form" /> 
                            <c:forEach items="#{groupBean.myProject}" var="uug">
                                <p:menuitem value="移动到#{uug.name}"  icon="ui-icon ui-icon-newwin" onclick="document.getElementById('form:groupid').value='#{uug.pid}';" action="#{groupBean.moveToGroup}" ajax="false" update="form" /> 
                            </c:forEach>
                        </p:contextMenu> 
                        <p:dataTable id="dataTable" paginator="true" rows="20" paginatorPosition="bottom" var="car" value="#{groupBean.alluserProjects}" widgetVar="carsTable"   
                                     rowKey="#{car.id}"  selection="#{groupBean.selectUserProject}"  selectionMode="single"      emptyMessage="没有相关记录！"   >  

                            <f:facet name="header">  
                                <p:outputPanel>  
                                    <h:outputText value="Search all fields:" />  
                                    <p:inputText id="globalFilter" onkeyup="carsTable.filter()" style="width:150px" />  
                                </p:outputPanel>  
                            </f:facet> 

                            <p:column id="groupColumn" filterBy="#{car.pid.name}"   
                                      headerText="组织名称"   
                                      filterMatchMode="contains">  
                                <h:outputText value="#{car.pid.name}" />  
                            </p:column> 

                            <p:column id="userColumn" filterBy="#{car.uid.realname}"   
                                      headerText="成员名称" 
                                      filterMatchMode="contains">  
                                <h:outputText value="#{car.uid.realname}" />  
                            </p:column>  

                            <p:column id="yearColumn" filterBy="#{car.uid.email}"  
                                      headerText="邮箱"  filterMatchMode="contains">  
                                <h:outputText value="#{car.uid.email}" />  
                            </p:column>  

                            <p:column id="manufacturerColumn" filterBy="#{car.uid.ustcUserProfile.studentNo}"   
                                      headerText="学号" 
                                      filterMatchMode="contains">  
                                <h:outputText value="#{car.uid.ustcUserProfile.studentNo}" />  
                            </p:column>  
                        </p:dataTable>  
                    </p:layoutUnit>
                </p:layout>

            </h:form> 
        </f:view>
    </h:body>
</html>

