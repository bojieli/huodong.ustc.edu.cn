进度条(很牛)(html 支持asp,asp.net,dotnet,java,j2ee,php)

/*
ProgressBar.htm
*/
<html>
	<head>
		<meta charset=utf8>
		   <title></title>
		      <script language="javascript">
				  //设置进度条进度
				  function SetPorgressBar(msg, pos)
				  {
					  ProgressBar.style.width= pos + "%";
					  WriteText("Msg1",msg + "已完成" + pos + "%");
				  }
				  //设置进度条完成信息
				  function SetCompleted(msg)
				  {
					  if(msg=="")
					     WriteText("Msg1","完成。");
						    else
							    WriteText("Msg1",msg);     
							}
							// 更新文本显示信息
							function WriteText(id, str)
							{
								var strTag = '<font face="Verdana, Arial, Helvetica" size="2" color="#ea9b02"><B>' + str + '</B></font>';     
								if (document.all) document.all[id].innerHTML = strTag;
							}
							   </script>
						   </head>
						   <body>
							      <div align="center" style="font-size:12px;position:absolute;TOP:184px;LEFT:250px;overflow:visible">
									      <div align="left" id="Msg1"><font face="Verdana, Arial, Helvetica" size="2" color="#ea9b02"><b>正在加载</b></font></div>
										      <div align="left" id="ProgressBarSide" style="color:Silver;border-width:1px;border-style:Solid;width:300px;">
												      <div align="left" id="ProgressBar" style="background-color:#3366FF; height:21px; width:0%;"></div>
													      </div>
														     </div>
														 </body>
													 </html>
													 /*
													 .cs中加
													 */
													 //加进度条
													     string templateFileName = Path.Combine(Server.MapPath("."), "ProgressBar.htm");
														     StreamReader reader = new StreamReader(@templateFileName,System.Text.Encoding.GetEncoding("gb2312"));
															     string html = reader.ReadToEnd();
																     reader.Close();
																	     Response.Write(html);
																		     Response.Flush();
																			     System.Threading.Thread.Sleep(200);
																				     string jsBlock;
																					     //加进度条
																						 //--------------------------------------------------------------------------------------
																						 for(int i=0;i<ip;i++)
																						 {
																						 //加进度条进程
																						 //path 为文件名
																						      System.Threading.Thread.Sleep(10);
																							       jsBlock = "<script>SetPorgressBar('" +path + "','" + ((Convert.ToDouble(i)/Convert.ToDouble(ip))*100).ToString("N") + "');</script>";
																								        Response.Write(jsBlock);
																										     Response.Flush();
																											      //加进度条进程
																												  }http://hi.baidu.com/wenwenxiaoxing/blog/item/845271cfff0f273cf9dc615d.html

